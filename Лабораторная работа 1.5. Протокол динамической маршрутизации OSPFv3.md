## Лабораторная работа 1.5. Протокол динамической маршрутизации OSPFv3

### Описание сценария

Для маршрутизации IPv6 пакетов применимы несколько протоколов маршрутизации. RIPng (Next-GenerationRIP) является версией для IPv6 протокола маршрутизации RIP, маршрутной информацией которого является направление и дальность в хопах. EIGRP IPv6 и OSPFv3 также является версией для IPv6 протоколов маршрутизации EIGRP и OSPFv2 соответственно, поэтому основные компоненты как для IPv6, так и IPv4 одинаковы.

Согласно сценарию, компания, решила ввести адресацию IPv6, поэтому сетевому администратору было поручено настроить маршрутизацию между подразделениями.

### Задачи лабораторной работы

- Настроить базовые параметры протоколов динамической маршрутизации OSPFv3
- Обеспечить связность между клиентскими машинами

### Описание топологии

Топология состоит из двух клиентских машин PC-A и PC-B, и двух маршрутизаторов R1 и R2.

![](/assets/pics/1.5.1.png "Рис. 1.5.1. Топология")

| Устройство | Интерфейс | IP-адрес | Шлюз по умолчанию |
| --- | --- | --- | --- |
| R1 | G0/0 | 2001:DB8:5:12::1/64FE80::1 | - |
| | G0/2 | 2001:DB8:5:1::1/64FE80::1 | - |
| R2 | G0/0 | 2001:DB8:5:12::2/64FE80::2 | - |
| | G0/2 | 2001:DB8:5:2::1/64FE80::2 | - |
| PC-A | NIC | 2001:DB8:5:1::11/64 | FE80::1 |
| PC-B | NIC | 2001:DB8:5:2::11/64 | FE80::2 |

### Начальное состояние и базовые настройки устройств

- Интерфейсы всех устройств настроены в соответствии с таблицей адресации
- На всех маршрутизаторах включена маршрутизация для IPv6

### Проверка связности

1. Откройте консоль PC-A (учетная запись cisco\cisco) и выполните проверку доступности PC-B с помощью команды **ping6**.
2. Достижимости нет, потому что приватные сеть 2001:DB8:5:2::/64 отсутствует в таблице маршрутизации R1. Убедитесь в этом при помощи команды, выполнив команду **show ipv6 route 2001:DB8:5:2::/64** на маршрутизаторе R1.

```
PC-A:~$ ping6 -c 2 2001:DB8:5:2::11
PING 2001:DB8:5:2::11 (2001:db8:5:2::11): 56 data bytes
--- 2001:DB8:5:2::11 ping statistics ---
2 packets transmitted, 0 packets received, 100% packet loss

R1#show ipv6 route 2001:DB8:5:2::/64 
% Route not found
```

### Настройка динамической маршрутизации OSPFv3

1. На маршрутизаторе R2 создайте процесс OSPFv3 с идентификатором процесса 100 при помощи команды **ipv6 router ospf 100**.
2. В настройках процесса OSPFv3, поскольку IPv4 адресация отсутствует, задайте идентификатор маршрутизатора 2.2.2.2 при помощи команды **router-id 2.2.2.2**.
3. На маршрутизаторе R2 включите OSPFv3 на интерфейсе G0/0, который будет принадлежать магистральной зоне, при помощи команды **ipv6 ospf 100 area 0**.
4. На маршрутизаторе R2 включите OSPF на интерфейсе G0/2, который будет принадлежать зоне 2, при помощи команды **ipv6 ospf 100 area 2**.
5. Убедитесь, что на маршрутизаторе R2 процесс OSPFv3 успешно создан с соответствующими настройками.

```
R2(config)#ipv6 router ospf 100
R2(config-rtr)#router-id 2.2.2.2

R2(config)#interface g0/0  
R2(config-if)#ipv6 ospf 100 area 0
R2(config)# interface g0/2            
R2(config-if)#ipv6 ospf 100 area 2

R2#show ipv6 protocols | begin ospf
IPv6 Routing Protocol is "ospf 100"
  Router ID 2.2.2.2
  Interfaces (Area 0):
    GigabitEthernet0/0
  Interfaces (Area 2):
    GigabitEthernet0/2
```

6. Аналогично на маршрутизаторе R1 создайте процесс OSPFv3 с идентификатором процесса 100, задайте идентификатор маршрутизатора 1.1.1.1 и включите сам процесс на интерфейсах G0/0 – зона 0 и G0/2 – зона 1.
7. Убедитесь, что на маршрутизаторах R1 и R3 появились маршруты, полученные при помощи OSPFv3, к приватным сетям 2001:DB8:5:3::/64 и 2001:DB8:5:1::/64 соответственно.

```
R1(config)#ipv6 router ospf 100
R1(config-rtr)#router-id 1.1.1.1
R1(config)#interface g0/0  
R1(config-if)#ipv6 ospf 100 area 0
R1(config)# interface g0/2            
R1(config-if)#ipv6 ospf 100 area 1

R1#sh ipv6 ro 2001:DB8:5:2::/64
Routing entry for 2001:DB8:5:2::/64
  Known via "ospf 100", distance 110, metric 2, type inter area
  Routing paths:
    FE80::2, GigabitEthernet0/0
      From FE80::2

R2#sh ipv6 ro 2001:DB8:5:1::/64
Routing entry for 2001:DB8:5:1::/64
  Known via "ospf 100", distance 110, metric 2, type inter area
  Routing paths:
    FE80::1, GigabitEthernet0/1
      From FE80::1
```

8. С клиентской машины PC-A выполните проверку доступности PC-B при помощи команды ping6.

```
PC-A:~$ ping6 -c 2 2001:DB8:5:2::11
PING 2001:DB8:5:2::11 (2001:db8:5:3::11): 56 data bytes
64 bytes from 2001:db8:5:2::11: seq=0 ttl=62 time=4.874 ms
64 bytes from 2001:db8:5:2::11: seq=1 ttl=62 time=6.149 ms
--- 2001:DB8:5:3::11 ping statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
```